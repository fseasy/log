---
title: '20 Feb 2026'
date: '2026-02-20T15:01:49+08:00'
description: "莫要急躁，急切，学会“明日再战“，多多提升吧。" # highlight
structure_log: 
  exercise: "-"
  reading: "-"
  draw: "-"
  pronounce: "-"
  wip_project: ["dajuan-english"]
---

## 事项记录

### Todo
- 部署到 fseasy.top
  1. github action 侧：触发 update. [DONE]
  1. vps 侧：update
     进入到 work dir
     1. 获取最新的 prod conf (从 private-conf 里)，覆盖 [done]
     1. 拉取最新的 release 分支 [done]
     2. gen conf [done]
     3. pnpm run prod [done]
     4. uv install (new dependency) [done]
     5. kill -HUP $(cat /var/run/gunicorn.pid)  # 优雅 reload => 基于 systemd restart 完成 【done】
     6. nginx reload 【done】

  

- supertokens role 的 auth 还行吗？速度感觉是一个问题？ [hold]
  - 看起来 get-session 就是要请求一次 core，是因为 parentRefreshTokenHash1 有值。 先这样吧，部署到 server 上看看耗时分析，要是还是很慢，可能就改用直接的 jwt 验证了。应该也是 ok 的
  
  => 看起来偶尔还是有高的延时，需要把它给换成 jwt 吧！
  => NO, 看了下日志，似乎没看出来高延时，都是 0.004 这个级别；我觉得做一个接口层面的耗时监控是更重要的！

- page 优化：
  - 增加面包屑
  - 表格样式优化？
  - navbar 对齐主题色，对齐宽度

- 上线后 TODO
  - 配置 Stripe webhook： 
    - 创建 Webhook 端点

      After testing locally, get your webhook event handler up and running on your server. Next, create a webhook endpoint to send checkout.session.completed events to your server, then test the Checkout flow again.

      https://docs.stripe.com/webhooks#register-webhook

### Process

解决了很久的 Nginx 相关的问题。

1. 之前的资源文件权限设置是有问题的—因为前面的 /docs/ 用的 ^~ 优先级更高，匹配到后，根本不会走后面的资源匹配规则。解决方法是把这些额外的规则，都放到 /docs/ 里面，做内部的二次匹配，这才是对的
2. 遇到了 refresh-session 失败的问题。 折腾了半天，看了 nginx error log, 才发现原来是 supertokens 返回的 package 太大，超过了 buffer size 导致的问题。log 很重要啊
3. 增加了部分文档的开放权限

-----

## 情绪记录

### Good

### Bad

-----

## Reflect

自己又太着急了。当 nginx 问题导致 session refresh 失败的时候，黄车车也在闹，然后我完全把黄车车交给了妈妈兜底。
自己晚上又搞到 12 点 40 才睡觉，第二天 9 点才起来。

急躁。